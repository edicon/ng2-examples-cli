{"version":3,"file":"synth.component.js","sourceRoot":"","sources":["synth.component.ts"],"names":[],"mappings":"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","sourcesContent":["import config from '../../conf';\nimport { Component, ChangeDetectorRef, ElementRef, OnInit } from '@angular/core';\nimport { NgClass, Control, ControlGroup, FormBuilder, FORM_PROVIDERS, FORM_DIRECTIVES } from '@angular/common';\nimport { DataChannel } from '../../services/data-channel';\nimport { Synth } from '../../scene/synth.scene';\nimport { ButtonComponent } from '../../components/button/button.component';\n\ndeclare let module: any;\n\n@Component({\n  selector: 'view',\n  moduleId: module.id,\n  templateUrl: 'synth.component.html',\n  styleUrls: ['synth.component.css'],\n  providers: [ FORM_PROVIDERS ],\n  directives: [ FORM_DIRECTIVES, ButtonComponent ]\n})\n\nexport class SynthComponent implements OnInit {\n\n  copy: any;\n  client: any;\n  messages: any;\n  isConnected: boolean;\n  isConnecting: boolean;\n  isButtonDisabled: boolean;\n  form: ControlGroup;\n  room: Control;\n  toggleInvert : number;\n  ref: ChangeDetectorRef;\n  elem: any;\n  world: any;\n  \n  constructor(private _ref: ChangeDetectorRef,\n              private _el: ElementRef,\n              private _fb: FormBuilder ) {\n\n    this.ref = _ref;\n    this.elem = _el.nativeElement;\n    this.messages = [];\n    this.isConnected = false;\n    this.isConnecting = false;\n    this.isButtonDisabled = true;\n    this.toggleInvert = 1;\n      \n    this.copy = {\n      headline : 'Synth',\n      line1: 'Visit /ui on a mobile device',\n      line2: 'Use this code to connect the controller'\n    };\n    \n    this.room = new Control(config.room);\n    \n    this.form = _fb.group({\n      'room': this.room\n    });\n\n  }\n  ngOnInit() {\n\n    this.world = new Synth(this.elem.querySelector('video'), \n                            true, \n                            true,\n                            [{\n                              \"camera\": \"0.0,-1130.0,1680.0\",\n                              \"shape\": \"plane\",\n                              \"detail\": 480,\n                              \"scale\" : 10.0,\n                              \"wireframe\": false,\n                              \"multiplier\": 15.0,\n                              \"displace\": 3.3,\n                              \"origin\": \"0,0,-2000.0\",\n                              \"opacity\": 0.3,\n                              \"hue\": 0,\n                              \"saturation\": 0.7,\n                              \"bgColor\": \"#000\"\n                          }]);\n    \n    this.world.setContainer(this.elem.querySelector('.scene'));\n    this.world.defaultVideo('/assets/video/kinetic-light.mp4');\n    this.world.update();\n    \n    this.form.valueChanges.subscribe((val) => {\n         console.log(JSON.stringify(val));\n         if(val.room.length === 5) {\n           this.isButtonDisabled = false;\n         } else {\n           this.isButtonDisabled = true;\n         }\n    });\n    \n  }\n  onKeyDown(ev) {\n    \n\n  }\n  updateMessages(msg: any) {\n    console.log(msg);\n    let data : number[] = msg.currentValue;\n    \n    if(msg.control === 'joyLeft') {\n      if(data[0] < 0) {\n        console.log('left');\n        this.world.controls.moveLeft = true;\n        this.world.controls.moveRight = false;\n      } else {\n        this.world.controls.moveLeft = false;\n      }\n\n      if(data[0] > 0) {\n        console.log('right');\n        this.world.controls.moveLeft = false;\n        this.world.controls.moveRight = true;\n      } else {\n        this.world.controls.moveRight = false;\n      }\n\n\n      if(data[1] > 0) {\n        console.log('forward');\n        this.world.controls.moveForward = true;\n        this.world.controls.moveBackward = false;\n      } else {\n        this.world.controls.moveForward = false;\n      }\n\n      if(data[1] < 0) {\n        console.log('backward');\n        this.world.controls.moveBackward = true;\n        this.world.controls.moveForward = false;\n      } else {\n        this.world.controls.moveBackward = false;\n      }\n\n    }\n    \n    if(msg.control === 'joyRight') {\n        this.world.controls.mouseX = data[0];\n        this.world.controls.mouseY = data[1];\n    }\n    \n    if(msg.control === 'slider') {\n      \n      this.world.camera.position.y = msg.currentValue * this.toggleInvert;\n      \n    }\n    \n   if(msg.control === 'toggle') {\n      \n     this.toggleInvert = this.toggleInvert === 1 ? -1 : 1;\n      \n    }\n    \n    this.messages.push(msg);\n    this.ref.detectChanges();\n  }\n  onClick() {\n\n    if(!this.isConnected) {\n        \n      this.client = new DataChannel(config.room, config.username, config.server);\n      this.isConnecting = true;\n\n      this.client.emitter.subscribe((message)=>{\n\n        if(message === 'open') {\n          this.isConnected = true;\n          this.isConnecting = false;\n          this.client.observer.subscribe((res)=>{\n         \n            let msg = res[res.length-1].data; \n            console.log(msg);\n            this.updateMessages(msg);\n            \n          });\n          this.ref.detectChanges();\n        }\n\n      });\n\n    }\n\n  }\n}\n"]}